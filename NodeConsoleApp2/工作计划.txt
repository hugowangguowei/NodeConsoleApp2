我计划开发一个网页游戏；
（一）我想先实现一个简单的回合制战斗系统：
1. 在游戏中，有玩家控制角色和敌人角色两种角色类型；
2. 每个角色都有生命值（HP）的概念，当生命值降为0时，角色死亡；
3. 除生命值之外，角色有着装/护甲/抗性的概念，在有装/护甲/抗性的情况下，角色受到的伤害会显著减少；
4. 护甲跟部位有关，每个部位都有对应的护甲值，可以独立计算伤害减免；
5. 护甲可以被攻击破坏，被破坏的护甲会失去其减免效果；
6. 角色可以装备不同的武器，武器有不同的攻击力和特殊效果；
7. 角色可以使用技能，技能有不同的效果，比如造成伤害、治疗、增加护甲等；
8. 角色的攻击手段（武器/技能）需要选择攻击部位，比如头部/躯干/四肢等，不同部位受到的伤害不同；
9. 角色的攻击手段受行动力限制，每回合有一定的行动力值，攻击手段会消耗不同的行动力；
10.角色可以选择防御（防御是与攻击/技能相同层级的操作）。
11.在每个回合选定行动后，系统会根据角色的速度属性 + 技能的速度属性决定行动顺序，速度高的角色先行动；
12.游戏流程的核心在于针对敌人的特征选择合适的技能顺序。
（二）基于回合制战斗系统，设计敌人生成与关卡系统：

2025-12-28 21:00（编辑）
帮我系统分析一下battle_scene_proposal.md场景接口，并重写这个md文件，我建议方案包括如下章节：
1.场景模块构建目标
2.场景模块设计理念
（作为松耦合的模块，能够以订阅者模式，订阅游戏主流程的事件，能够订阅场景初始化要素）
3.场景模块界面设计
3.1 主要讲述用什么技术栈（比如HTML，canvas,或者webGL)
3.2 对于人物角色，类似于纸娃娃系统的换装、动作系统如何实现
3.3 界面被拆分为什么样的模块？每个模块怎么组成？
3.4 布局样式是什么样的？
4.场景模块接口设计
4.1 主要讲述场景接口的核心设计理念，比如订阅模式监听游戏流程；
4.2 叙述具体要监听哪些事件，事件监听的频率，事件传递的数据结构

2025-12-28 21:20（编辑）
我希望你在design目录下创建core_engine.md文件，对游戏的核心引擎进行设计说明。
该引擎将以JS为主要开发语言。包括以下内容：
1. 帧循环设计；
2. 游戏流程设计（状态机设计）；
3. 事件系统设计（发布-订阅模式）；
4. 数据对象设计（角色对象，物品对象，场景对象等）；
5. 数据管理设计（数据存储，数据加载，数据缓存等）；

在该方案中会清楚地描述从登录，到关卡选择，到对战场景，到胜利失败结算的整个游戏流程。
但是不需要考虑二三维渲染相关的内容。引擎的输入输出可以以文字的形式做规范接口。

2025-12-28 21:40（编辑）
基于core_engine.md的设计，创建游戏引擎，引擎的代码以.js文件的形式储存到script/engine目录下。
创建测试html，放到test目录下，测试html可以通过浏览器打开，测试引擎的基本功能。

2025-12-29 20:50（编辑）
玩家行动中的输入部分需要改一下，在一回合的输入中并不是输入单个技能，而是从技能列表中选择
1-多个技能放入技能待释放区，这个过程可以从技能待释放区取消已选择技能。然后执行“技能配置完成”
功能，这时候敌人根据技能面板同样选择1-多个技能。敌人选择完成后，进入技能释放阶段，双方的技能
按照速度顺序依次释放。在这个过程中，玩家和敌人都不能再更改技能选择。根据这个要求，重新设计7.3 战斗场景 (核心循环)

2025-12-29 23:20（编辑）
我想对DataManager这部分内容，尤其是dataConfig进行深化设计。先不用着急写代码，在core_engine中
新增一个章节，叫做6. 数据配置设计（dataConfig设计）。基于这个章节，设计dataConfig的结构，
使其能够实现游戏状态的实时保存与加载。

2025-12-30 16:22（编辑）
用中文回复。我觉得你对于即时战斗场景的保存有些问题，当前的保存没有记录敌人的初始状态，当前状态，
以及历史回合状态，按照这个模式我载入数据的时候，无法还原到当前战斗过程。
先不着急更改引擎代码，在引擎的设计文档中先明确好你的数据存储方案，尤其是在战斗过程中的数据存储方案。

// 4. 历史记录 (History)这个章节设计的不好，历史记录记的不是数据日志，而应该是过去回合玩家、敌人行为
和结果的合集。请确认这个方案是否合理，如果合理，按照这个思路更新md文件，先不用更新代码。

2025-12-31 00:03（编辑）
我对功能进行了测试，发现了如下问题：在第2或第3回合开始阶段我进行了游戏保存。然后进行重新载入，在重新
载入的游戏下，AP值足够的情况下，技能按钮也是不可点击状态，无法进行技能选择。请你检查一下这个问题，先
不用着急改代码，分析原因。

2025-12-31 21:48（编辑）
我认为当前关卡配置，敌人配置都是写死在代码中的，请确认是否如此，如果确实是写死的，我希望在设计文档提供
一个用JSON配置关卡和敌人的方案。这样我可以通过修改JSON文件来调整关卡和敌人配置，而不需要改动代码。先别
着急改代码，先在设计文档中补充这个方案。